
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Inlets Secure Tunnels From Dev to Cloud">
      
      
        <meta name="author" content="OpenFaaS Ltd">
      
      
        <link rel="canonical" href="https://docs.inlets.dev/tutorial/ssh-tcp-tunnel/">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.6">
    
    
      
        <title>Tutorial: Expose a private SSH server over a TCP tunnel - Inlets</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.558e4712.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.2505c338.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto,+Helvetica:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto, Helvetica";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-MVH8L09LKP"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-MVH8L09LKP",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-MVH8L09LKP",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>

  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tutorial-expose-a-private-ssh-server-over-a-tcp-tunnel" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Inlets" class="md-header__button md-logo" aria-label="Inlets" data-md-component="logo">
      
  <img src="../../images/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Inlets
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Tutorial: Expose a private SSH server over a TCP tunnel
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/inlets" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    inlets/inlets
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Inlets" class="md-nav__button md-logo" aria-label="Inlets" data-md-component="logo">
      
  <img src="../../images/logo.svg" alt="logo">

    </a>
    Inlets
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/inlets" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    inlets/inlets
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      
      
        <label class="md-nav__link" for="__nav_1" tabindex="0" aria-expanded="false">
          Overview
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Overview" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Overview
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="/reference/faq/" class="md-nav__link">
        FAQ
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" tabindex="0" aria-expanded="false">
          Tutorials
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tutorials" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="/tutorial/manual-http-server/" class="md-nav__link">
        Create a manual HTTP tunnel server
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="/tutorial/automated-http-server/" class="md-nav__link">
        Create an automated HTTP tunnel server
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="/tutorial/dual-tunnels/" class="md-nav__link">
        Dual TCP and HTTP tunnels
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://inlets.dev/blog/2021/12/06/private-deploy-from-github-actions.html" class="md-nav__link">
        GitHub Actions (ext)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://inlets.dev/blog/2021/10/15/allow-lists.html" class="md-nav__link">
        IP Allow list (ext)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://inlets.dev/blog/2021/09/09/compose-and-inlets.html" class="md-nav__link">
        Docker Compose (ext)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="/tutorial/community/" class="md-nav__link">
        Community tutorials
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" tabindex="0" aria-expanded="false">
          Tutorials for TCP tunnels
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tutorials for TCP tunnels" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Tutorials for TCP tunnels
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="/tutorial/caddy-http-tunnel/" class="md-nav__link">
        Run Caddy on a private network
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://inlets.dev/blog/2021/04/13/local-port-forwarding-kubernetes.html" class="md-nav__link">
        Local port forwarding
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="/tutorial/ssh-tcp-tunnel/" class="md-nav__link">
        Tunnel SSH
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="/tutorial/postgresql-tcp-tunnel/" class="md-nav__link">
        Tunnel Postgresql
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" tabindex="0" aria-expanded="false">
          Kubernetes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Kubernetes" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Kubernetes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="/tutorial/kubernetes-ingress/" class="md-nav__link">
        Kubernetes Ingress
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="/tutorial/kubernetes-api-server/" class="md-nav__link">
        Kubernetes API Server
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/inlets/inlets-pro/tree/master/chart" class="md-nav__link">
        Helm charts (ext)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://inlets.dev/blog/2022/06/24/fixing-kubectl-port-forward.html" class="md-nav__link">
        Local port forwarding (ext)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://inlets.dev/blog/2022/08/10/managing-tunnel-servers-with-argocd.html" class="md-nav__link">
        Manage private clusters with ArgoCD (ext)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="/tutorial/istio-gateway/" class="md-nav__link">
        Istio Gateway
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" tabindex="0" aria-expanded="false">
          Inlets Uplink
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Inlets Uplink" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Inlets Uplink
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="/uplink/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="/uplink/become-a-provider/" class="md-nav__link">
        Become a provider
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="/uplink/create-tunnels/" class="md-nav__link">
        Create a tunnel
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="/uplink/manage-tunnels/" class="md-nav__link">
        Manage tunnels
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="/uplink/connect-to-tunnels/" class="md-nav__link">
        Connect to tunnels
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="/uplink/monitoring-tunnels/" class="md-nav__link">
        Monitor tunnels
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="/uplink/ingress-for-tunnels/" class="md-nav__link">
        Ingress for tunnels
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6" tabindex="0" aria-expanded="false">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="/reference/inlets-operator/" class="md-nav__link">
        Inlets Operator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="/reference/inletsctl/" class="md-nav__link">
        inletsctl
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="/tutorial/monitoring-and-metrics/" class="md-nav__link">
        Monitoring and metrics
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#setup-your-tunnel-server-with-inletsctl" class="md-nav__link">
    Setup your tunnel server with inletsctl
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-an-tunnel-server" class="md-nav__link">
    Create an tunnel server
  </a>
  
    <nav class="md-nav" aria-label="Create an tunnel server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-automate-your-tunnel-server" class="md-nav__link">
    A) Automate your tunnel server
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-manual-setup-of-your-tunnel-server" class="md-nav__link">
    B) Manual setup of your tunnel server
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure-the-private-ssh-servers-listening-port" class="md-nav__link">
    Configure the private SSH server's listening port
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#start-the-inlets-pro-client" class="md-nav__link">
    Start the inlets Pro client
  </a>
  
    <nav class="md-nav" aria-label="Start the inlets Pro client">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#try-it-out" class="md-nav__link">
    Try it out
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wrapping-up" class="md-nav__link">
    Wrapping up
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="tutorial-expose-a-private-ssh-server-over-a-tcp-tunnel">Tutorial: Expose a private SSH server over a TCP tunnel<a class="headerlink" href="#tutorial-expose-a-private-ssh-server-over-a-tcp-tunnel" title="Permanent link">&para;</a></h1>
<p>In this tutorial we will use inlets-pro to access your computer behind NAT or a firewall. We'll do this by tunnelling SSH over inlets-pro, and clients will connect to your exit-server.</p>
<p>Scenario: You want to allow SSH access to a computer that doesn't have a public IP, is inside a private network or behind a firewall. A common scenario is connecting to a Raspberry Pi on a home network or a home-lab.</p>
<blockquote>
<p>You can <a href="https://inlets.dev/blog/2021/07/27/monthly-subscription.html">subscribe to inlets for personal or commercial use via Gumroad</a></p>
</blockquote>
<h2 id="setup-your-tunnel-server-with-inletsctl">Setup your tunnel server with <code>inletsctl</code><a class="headerlink" href="#setup-your-tunnel-server-with-inletsctl" title="Permanent link">&para;</a></h2>
<p>For this tutorial you will need to have an account and API key with one of the <a href="https://github.com/inlets/inletsctl#featuresbacklog">supported providers</a>, or you can create an exit-server manually and install inlets Pro there yourself.</p>
<p>For this tutorial, the <a href="https://m.do.co/c/8d4e75e9886f">DigitalOcean provider will be used</a>. You can get <a href="https://m.do.co/c/8d4e75e9886f">free credits on DigitalOcean with this link</a>.</p>
<p>Create an API key in the DigitalOcean dashboard with Read and Write permissions, and download it to a file called <code>do-access-token</code> in your home directory.</p>
<p>You need to know the IP of the machine you to connect to on your local network, for instance <code>192.168.0.35</code> or <code>127.0.0.1</code> if you are running inlets Pro on the same host as SSH.</p>
<p>You can use the <code>inletsctl</code> utility to provision exit-servers with inlets Pro preinstalled, it can also download the <code>inlets-pro</code> CLI.</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-sLSf<span class="w"> </span>https://inletsctl.inlets.dev<span class="w"> </span><span class="p">|</span><span class="w"> </span>sh
sudo<span class="w"> </span>mv<span class="w"> </span>inletsctl<span class="w"> </span>/usr/local/bin/
sudo<span class="w"> </span>inletsctl<span class="w"> </span>download
</code></pre></div>
<p>If you already have <code>inletsctl</code> installed, then make sure you update it with <code>inletsctl update</code>.</p>
<h2 id="create-an-tunnel-server">Create an tunnel server<a class="headerlink" href="#create-an-tunnel-server" title="Permanent link">&para;</a></h2>
<h3 id="a-automate-your-tunnel-server">A) Automate your tunnel server<a class="headerlink" href="#a-automate-your-tunnel-server" title="Permanent link">&para;</a></h3>
<p>The inletsctl tool can create a tunnel server for you in the region and cloud of your choice.</p>
<div class="highlight"><pre><span></span><code>inletsctl<span class="w"> </span>create<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--provider<span class="w"> </span>digitalocean<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--access-token-file<span class="w"> </span>~/do-access-token<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--region<span class="w"> </span>lon1
</code></pre></div>
<p>Run <code>inletsctl create --help</code> to see all the options.</p>
<p>After the machine has been created, <code>inletsctl</code> will output a sample command for the <code>inlets-pro client</code> command:</p>
<div class="highlight"><pre><span></span><code>inlets-pro<span class="w"> </span>tcp<span class="w"> </span>client<span class="w"> </span>--url<span class="w"> </span><span class="s2">&quot;wss://206.189.114.179:8123/connect&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--token<span class="w"> </span><span class="s2">&quot;4NXIRZeqsiYdbZPuFeVYLLlYTpzY7ilqSdqhA0HjDld1QjG8wgfKk04JwX4i6c6F&quot;</span>
</code></pre></div>
<p>Don't run this command, but note down the <code>--url</code> and <code>--token</code> parameters for later</p>
<h3 id="b-manual-setup-of-your-tunnel-server">B) Manual setup of your tunnel server<a class="headerlink" href="#b-manual-setup-of-your-tunnel-server" title="Permanent link">&para;</a></h3>
<p>Use B) if you want to provision your virtual machine manually, or if you already have a host from another provider.</p>
<p>Log in to your remote tunnel server with <code>ssh</code> and obtain the binary using <code>inletsctl</code>:</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-sLSf<span class="w"> </span>https://inletsctl.inlets.dev<span class="w"> </span><span class="p">|</span><span class="w"> </span>sh
sudo<span class="w"> </span>mv<span class="w"> </span>inletsctl<span class="w"> </span>/usr/local/bin/
sudo<span class="w"> </span>inletsctl<span class="w"> </span>download
</code></pre></div>
<p>Find your public IP:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">IP</span><span class="o">=</span><span class="k">$(</span>curl<span class="w"> </span>-s<span class="w"> </span>ifconfig.co<span class="k">)</span>
</code></pre></div>
<p>Confirm the IP with <code>echo $IP</code> and save it, you need it for the client</p>
<p>Get an auth token and save it for later to use with the client</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">TOKEN</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>head<span class="w"> </span>-c<span class="w"> </span><span class="m">16</span><span class="w"> </span>/dev/urandom<span class="w"> </span><span class="p">|</span>shasum<span class="p">|</span>cut<span class="w"> </span>-d<span class="s1">&#39;-&#39;</span><span class="w"> </span>-f1<span class="k">)</span><span class="s2">&quot;</span>

<span class="nb">echo</span><span class="w"> </span><span class="nv">$TOKEN</span>
</code></pre></div>
<p>Start the server:</p>
<div class="highlight"><pre><span></span><code>inlets-pro<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>server<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--auto-tls<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--auto-tls-san<span class="w"> </span><span class="nv">$IP</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--token<span class="w"> </span><span class="nv">$TOKEN</span>
</code></pre></div>
<p>If running the inlets client on the same host as SSH, you can simply set <code>PROXY_TO_HERE</code> to <code>localhost</code>. Or if you are running SSH on a different computer to the inlets client, then you can specify a DNS entry or an IP address like <code>192.168.0.15</code>.</p>
<p>If using this manual approach to install inlets Pro, you should create a systemd unit file.</p>
<p>The easiest option is to run the server with the <code>--generate=systemd</code> flag, which will generate a systemd unit file to stdout. You can then copy the output to <code>/etc/systemd/system/inlets-pro.service</code> and enable it with <code>systemctl enable inlets-pro</code>.</p>
<h2 id="configure-the-private-ssh-servers-listening-port">Configure the private SSH server's listening port<a class="headerlink" href="#configure-the-private-ssh-servers-listening-port" title="Permanent link">&para;</a></h2>
<p>It's very likely (almost certain) that your exit server will already be listening for traffic on the standard ssh port <code>22</code>. Therefore you will need to configure your internal server to use an additional TCP port such as <code>2222</code>.</p>
<p>Once configured, you'll still be able to connect to the internal server on port 22, but to connect via the tunnel, you'll use port <code>2222</code></p>
<p>Add the following to  <code>/etc/ssh/sshd_config</code>:</p>
<div class="highlight"><pre><span></span><code>Port<span class="w"> </span><span class="m">22</span>
Port<span class="w"> </span><span class="m">2222</span>
</code></pre></div>
<p>For (optional) additional security, you could also disable password authentication, but make sure that you have inserted your SSH key to the internal server with <code>ssh-copy-id user@ip</code> before reloading the SSH service.</p>
<div class="highlight"><pre><span></span><code>PasswordAuthentication<span class="w"> </span>no
</code></pre></div>
<p>Now need to reload the service so these changes take effect</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>daemon-reload
sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>sshd
</code></pre></div>
<p>Check that you can still connect on the internal IP on port 22, and the new port 2222.</p>
<p>Use the <code>-p</code> flag to specify the SSH port:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">IP</span><span class="o">=</span><span class="s2">&quot;192.168.0.35&quot;</span>

ssh<span class="w"> </span>-p<span class="w"> </span><span class="m">22</span><span class="w"> </span><span class="nv">$IP</span><span class="w"> </span><span class="s2">&quot;uptime&quot;</span>
ssh<span class="w"> </span>-p<span class="w"> </span><span class="m">2222</span><span class="w"> </span><span class="nv">$IP</span><span class="w"> </span><span class="s2">&quot;uptime&quot;</span>
</code></pre></div>
<h2 id="start-the-inlets-pro-client">Start the inlets Pro client<a class="headerlink" href="#start-the-inlets-pro-client" title="Permanent link">&para;</a></h2>
<p>First download the inlets-pro client onto the private SSH server:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>inletsctl<span class="w"> </span>download
</code></pre></div>
<p>Use the command from earlier to start the client on the server:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">IP</span><span class="o">=</span><span class="s2">&quot;206.189.114.179&quot;</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">TCP_PORTS</span><span class="o">=</span><span class="s2">&quot;2222&quot;</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">LICENSE_FILE</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">/LICENSE.txt&quot;</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">UPSTREAM</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span>

inlets-pro<span class="w"> </span>tcp<span class="w"> </span>client<span class="w"> </span>--url<span class="w"> </span><span class="s2">&quot;wss://</span><span class="nv">$IP</span><span class="s2">:8123/connect&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--token<span class="w"> </span><span class="s2">&quot;4NXIRZeqsiYdbZPuFeVYLLlYTpzY7ilqSdqhA0HjDld1QjG8wgfKk04JwX4i6c6F&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--license-file<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$LICENSE_FILE</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--upstream<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$UPSTREAM</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--ports<span class="w"> </span><span class="nv">$TCP_PORTS</span>
</code></pre></div>
<p>The <code>localhost</code> value will be used for <code>--upstream</code> because the tunnel client is running on the same machine as the SSH service. However, you could run the client on another machine within the network, and then change the flag to point to the private SSH server's IP.</p>
<h3 id="try-it-out">Try it out<a class="headerlink" href="#try-it-out" title="Permanent link">&para;</a></h3>
<p>Verify the installation by trying to SSH to the public IP, using port <code>2222</code>.</p>
<div class="highlight"><pre><span></span><code>ssh<span class="w"> </span>-p<span class="w"> </span><span class="m">2222</span><span class="w"> </span>user@206.189.114.179
</code></pre></div>
<p>You should now have access to your server via SSH over the internet with the IP of the exit server.</p>
<p>You can also use other compatible tools like <code>sftp</code>, <code>scp</code> and <code>rsync</code>, just make sure that you set the appropriate port flag. The port flag for sftp is <code>-P</code> rather than <code>-p</code>.</p>
<h2 id="wrapping-up">Wrapping up<a class="headerlink" href="#wrapping-up" title="Permanent link">&para;</a></h2>
<p>The principles in this tutorial can be adapted for other protocols that run over TCP such as MongoDB or PostgreSQL, just adapt the port number as required.</p>
<ul>
<li><a href="https://docs.inlets.dev/#/get-started/quickstart-tcp-database">Quick-start: Tunnel a private database over inlets Pro</a></li>
<li><a href="https://inlets.dev/pricing">Purchase inlets for personal or commercial use</a></li>
</ul>


  




                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2021 OpenFaaS Ltd

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tracking", "navigation.sections"], "search": "../../assets/javascripts/workers/search.e5c33ebb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.51d95adb.min.js"></script>
      
    
  </body>
</html>